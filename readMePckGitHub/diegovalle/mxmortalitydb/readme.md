


<!DOCTYPE html>
<html lang="en" class="">
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    
    
    <title>mxmortalitydb/readme.md at master · diegovalle/mxmortalitydb · GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-114.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-144.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144.png">
    <meta property="fb:app_id" content="1401488693436528">

      <meta content="@github" name="twitter:site" /><meta content="summary" name="twitter:card" /><meta content="diegovalle/mxmortalitydb" name="twitter:title" /><meta content="mxmortalitydb - A data only R package containing all injury intent deaths registered from 2004 to 2013 in Mexico" name="twitter:description" /><meta content="https://avatars3.githubusercontent.com/u/125927?v=3&amp;s=400" name="twitter:image:src" />
      <meta content="GitHub" property="og:site_name" /><meta content="object" property="og:type" /><meta content="https://avatars3.githubusercontent.com/u/125927?v=3&amp;s=400" property="og:image" /><meta content="diegovalle/mxmortalitydb" property="og:title" /><meta content="https://github.com/diegovalle/mxmortalitydb" property="og:url" /><meta content="mxmortalitydb - A data only R package containing all injury intent deaths registered from 2004 to 2013 in Mexico" property="og:description" />
      <meta name="browser-stats-url" content="/_stats">
    <link rel="assets" href="https://assets-cdn.github.com/">
    
    <meta name="pjax-timeout" content="1000">
    

    <meta name="msapplication-TileImage" content="/windows-tile.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="selected-link" value="repo_source" data-pjax-transient>
      <meta name="google-analytics" content="UA-3769691-2">

    <meta content="collector.githubapp.com" name="octolytics-host" /><meta content="collector-cdn.github.com" name="octolytics-script-host" /><meta content="github" name="octolytics-app-id" /><meta content="C1BEC101:666F:3F53EEA:55103AFA" name="octolytics-dimension-request_id" />
    
    <meta content="Rails, view, blob#show" name="analytics-event" />

    
    <link rel="icon" type="image/x-icon" href="https://assets-cdn.github.com/favicon.ico">


    <meta content="authenticity_token" name="csrf-param" />
<meta content="Reh+mJXQSvXFPb0Ugl9/QimANga27ObUV1xtcEgSwRctrRUgCLbvPvpRye8XwbmmsGT4/2QweVBJAirqpGI9gQ==" name="csrf-token" />

    <link href="https://assets-cdn.github.com/assets/github-099e0ecc2851c8aca89ef6dafa191df3b0f2a2c8ad34e134c5473ca1ba0a59b2.css" media="all" rel="stylesheet" />
    <link href="https://assets-cdn.github.com/assets/github2-1171344316fc088255ee2a06c271d14240f1a4e06985fe9e897762947872e858.css" media="all" rel="stylesheet" />
    
    


    <meta http-equiv="x-pjax-version" content="c0f32272c66bfb10ed7d46b7c88c6299">

      
  <meta name="description" content="mxmortalitydb - A data only R package containing all injury intent deaths registered from 2004 to 2013 in Mexico">
  <meta name="go-import" content="github.com/diegovalle/mxmortalitydb git https://github.com/diegovalle/mxmortalitydb.git">

  <meta content="125927" name="octolytics-dimension-user_id" /><meta content="diegovalle" name="octolytics-dimension-user_login" /><meta content="15207890" name="octolytics-dimension-repository_id" /><meta content="diegovalle/mxmortalitydb" name="octolytics-dimension-repository_nwo" /><meta content="true" name="octolytics-dimension-repository_public" /><meta content="false" name="octolytics-dimension-repository_is_fork" /><meta content="15207890" name="octolytics-dimension-repository_network_root_id" /><meta content="diegovalle/mxmortalitydb" name="octolytics-dimension-repository_network_root_nwo" />
  <link href="https://github.com/diegovalle/mxmortalitydb/commits/master.atom" rel="alternate" title="Recent Commits to mxmortalitydb:master" type="application/atom+xml">

  </head>


  <body class="logged_out  env-production  vis-public page-blob">
    <a href="#start-of-content" tabindex="1" class="accessibility-aid js-skip-to-content">Skip to content</a>
    <div class="wrapper">
      
      
      


        
        <div class="header header-logged-out" role="banner">
  <div class="container clearfix">

    <a class="header-logo-wordmark" href="https://github.com/" data-ga-click="(Logged out) Header, go to homepage, icon:logo-wordmark">
      <span class="mega-octicon octicon-logo-github"></span>
    </a>

    <div class="header-actions" role="navigation">
        <a class="btn btn-primary" href="/join" data-ga-click="(Logged out) Header, clicked Sign up, text:sign-up">Sign up</a>
      <a class="btn" href="/login?return_to=%2Fdiegovalle%2Fmxmortalitydb%2Fblob%2Fmaster%2Freadme.md" data-ga-click="(Logged out) Header, clicked Sign in, text:sign-in">Sign in</a>
    </div>

    <div class="site-search repo-scope js-site-search" role="search">
      <form accept-charset="UTF-8" action="/diegovalle/mxmortalitydb/search" class="js-site-search-form" data-global-search-url="/search" data-repo-search-url="/diegovalle/mxmortalitydb/search" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
  <input type="text"
    class="js-site-search-field is-clearable"
    data-hotkey="s"
    name="q"
    placeholder="Search"
    data-global-scope-placeholder="Search GitHub"
    data-repo-scope-placeholder="Search"
    tabindex="1"
    autocapitalize="off">
  <div class="scope-badge">This repository</div>
</form>
    </div>

      <ul class="header-nav left" role="navigation">
          <li class="header-nav-item">
            <a class="header-nav-link" href="/explore" data-ga-click="(Logged out) Header, go to explore, text:explore">Explore</a>
          </li>
          <li class="header-nav-item">
            <a class="header-nav-link" href="/features" data-ga-click="(Logged out) Header, go to features, text:features">Features</a>
          </li>
          <li class="header-nav-item">
            <a class="header-nav-link" href="https://enterprise.github.com/" data-ga-click="(Logged out) Header, go to enterprise, text:enterprise">Enterprise</a>
          </li>
          <li class="header-nav-item">
            <a class="header-nav-link" href="/blog" data-ga-click="(Logged out) Header, go to blog, text:blog">Blog</a>
          </li>
      </ul>

  </div>
</div>



      <div id="start-of-content" class="accessibility-aid"></div>
          <div class="site" itemscope itemtype="http://schema.org/WebPage">
    <div id="js-flash-container">
      
    </div>
    <div class="pagehead repohead instapaper_ignore readability-menu">
      <div class="container">
        
<ul class="pagehead-actions">

  <li>
      <a href="/login?return_to=%2Fdiegovalle%2Fmxmortalitydb"
    class="btn btn-sm btn-with-count tooltipped tooltipped-n"
    aria-label="You must be signed in to watch a repository" rel="nofollow">
    <span class="octicon octicon-eye"></span>
    Watch
  </a>
  <a class="social-count" href="/diegovalle/mxmortalitydb/watchers">
    1
  </a>

  </li>

  <li>
      <a href="/login?return_to=%2Fdiegovalle%2Fmxmortalitydb"
    class="btn btn-sm btn-with-count tooltipped tooltipped-n"
    aria-label="You must be signed in to star a repository" rel="nofollow">
    <span class="octicon octicon-star"></span>
    Star
  </a>

    <a class="social-count js-social-count" href="/diegovalle/mxmortalitydb/stargazers">
      3
    </a>

  </li>

    <li>
      <a href="/login?return_to=%2Fdiegovalle%2Fmxmortalitydb"
        class="btn btn-sm btn-with-count tooltipped tooltipped-n"
        aria-label="You must be signed in to fork a repository" rel="nofollow">
        <span class="octicon octicon-repo-forked"></span>
        Fork
      </a>
      <a href="/diegovalle/mxmortalitydb/network" class="social-count">
        2
      </a>
    </li>
</ul>

        <h1 itemscope itemtype="http://data-vocabulary.org/Breadcrumb" class="entry-title public">
          <span class="mega-octicon octicon-repo"></span>
          <span class="author"><a href="/diegovalle" class="url fn" itemprop="url" rel="author"><span itemprop="title">diegovalle</span></a></span><!--
       --><span class="path-divider">/</span><!--
       --><strong><a href="/diegovalle/mxmortalitydb" class="js-current-repository" data-pjax="#js-repo-pjax-container">mxmortalitydb</a></strong>

          <span class="page-context-loader">
            <img alt="" height="16" src="https://assets-cdn.github.com/assets/spinners/octocat-spinner-32-e513294efa576953719e4e2de888dd9cf929b7d62ed8d05f25e731d02452ab6c.gif" width="16" />
          </span>

        </h1>
      </div><!-- /.container -->
    </div><!-- /.repohead -->

    <div class="container">
      <div class="repository-with-sidebar repo-container new-discussion-timeline  ">
        <div class="repository-sidebar clearfix">
            
<nav class="sunken-menu repo-nav js-repo-nav js-sidenav-container-pjax js-octicon-loaders"
     role="navigation"
     data-pjax="#js-repo-pjax-container"
     data-issue-count-url="/diegovalle/mxmortalitydb/issues/counts">
  <ul class="sunken-menu-group">
    <li class="tooltipped tooltipped-w" aria-label="Code">
      <a href="/diegovalle/mxmortalitydb" aria-label="Code" class="selected js-selected-navigation-item sunken-menu-item" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches /diegovalle/mxmortalitydb">
        <span class="octicon octicon-code"></span> <span class="full-word">Code</span>
        <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/assets/spinners/octocat-spinner-32-e513294efa576953719e4e2de888dd9cf929b7d62ed8d05f25e731d02452ab6c.gif" width="16" />
</a>    </li>

      <li class="tooltipped tooltipped-w" aria-label="Issues">
        <a href="/diegovalle/mxmortalitydb/issues" aria-label="Issues" class="js-selected-navigation-item sunken-menu-item" data-hotkey="g i" data-selected-links="repo_issues repo_labels repo_milestones /diegovalle/mxmortalitydb/issues">
          <span class="octicon octicon-issue-opened"></span> <span class="full-word">Issues</span>
          <span class="js-issue-replace-counter"></span>
          <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/assets/spinners/octocat-spinner-32-e513294efa576953719e4e2de888dd9cf929b7d62ed8d05f25e731d02452ab6c.gif" width="16" />
</a>      </li>

    <li class="tooltipped tooltipped-w" aria-label="Pull requests">
      <a href="/diegovalle/mxmortalitydb/pulls" aria-label="Pull requests" class="js-selected-navigation-item sunken-menu-item" data-hotkey="g p" data-selected-links="repo_pulls /diegovalle/mxmortalitydb/pulls">
          <span class="octicon octicon-git-pull-request"></span> <span class="full-word">Pull requests</span>
          <span class="js-pull-replace-counter"></span>
          <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/assets/spinners/octocat-spinner-32-e513294efa576953719e4e2de888dd9cf929b7d62ed8d05f25e731d02452ab6c.gif" width="16" />
</a>    </li>


  </ul>
  <div class="sunken-menu-separator"></div>
  <ul class="sunken-menu-group">

    <li class="tooltipped tooltipped-w" aria-label="Pulse">
      <a href="/diegovalle/mxmortalitydb/pulse" aria-label="Pulse" class="js-selected-navigation-item sunken-menu-item" data-selected-links="pulse /diegovalle/mxmortalitydb/pulse">
        <span class="octicon octicon-pulse"></span> <span class="full-word">Pulse</span>
        <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/assets/spinners/octocat-spinner-32-e513294efa576953719e4e2de888dd9cf929b7d62ed8d05f25e731d02452ab6c.gif" width="16" />
</a>    </li>

    <li class="tooltipped tooltipped-w" aria-label="Graphs">
      <a href="/diegovalle/mxmortalitydb/graphs" aria-label="Graphs" class="js-selected-navigation-item sunken-menu-item" data-selected-links="repo_graphs repo_contributors /diegovalle/mxmortalitydb/graphs">
        <span class="octicon octicon-graph"></span> <span class="full-word">Graphs</span>
        <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/assets/spinners/octocat-spinner-32-e513294efa576953719e4e2de888dd9cf929b7d62ed8d05f25e731d02452ab6c.gif" width="16" />
</a>    </li>
  </ul>


</nav>

              <div class="only-with-full-nav">
                  
<div class="clone-url open"
  data-protocol-type="http"
  data-url="/users/set_protocol?protocol_selector=http&amp;protocol_type=clone">
  <h3><span class="text-emphasized">HTTPS</span> clone URL</h3>
  <div class="input-group js-zeroclipboard-container">
    <input type="text" class="input-mini input-monospace js-url-field js-zeroclipboard-target"
           value="https://github.com/diegovalle/mxmortalitydb.git" readonly="readonly">
    <span class="input-group-button">
      <button aria-label="Copy to clipboard" class="js-zeroclipboard btn btn-sm zeroclipboard-button" data-copied-hint="Copied!" type="button"><span class="octicon octicon-clippy"></span></button>
    </span>
  </div>
</div>

  
<div class="clone-url "
  data-protocol-type="subversion"
  data-url="/users/set_protocol?protocol_selector=subversion&amp;protocol_type=clone">
  <h3><span class="text-emphasized">Subversion</span> checkout URL</h3>
  <div class="input-group js-zeroclipboard-container">
    <input type="text" class="input-mini input-monospace js-url-field js-zeroclipboard-target"
           value="https://github.com/diegovalle/mxmortalitydb" readonly="readonly">
    <span class="input-group-button">
      <button aria-label="Copy to clipboard" class="js-zeroclipboard btn btn-sm zeroclipboard-button" data-copied-hint="Copied!" type="button"><span class="octicon octicon-clippy"></span></button>
    </span>
  </div>
</div>



<p class="clone-options">You can clone with
  <a href="#" class="js-clone-selector" data-protocol="http">HTTPS</a> or <a href="#" class="js-clone-selector" data-protocol="subversion">Subversion</a>.
  <a href="https://help.github.com/articles/which-remote-url-should-i-use" class="help tooltipped tooltipped-n" aria-label="Get help on which URL is right for you.">
    <span class="octicon octicon-question"></span>
  </a>
</p>



                <a href="/diegovalle/mxmortalitydb/archive/master.zip"
                   class="btn btn-sm sidebar-button"
                   aria-label="Download the contents of diegovalle/mxmortalitydb as a zip file"
                   title="Download the contents of diegovalle/mxmortalitydb as a zip file"
                   rel="nofollow">
                  <span class="octicon octicon-cloud-download"></span>
                  Download ZIP
                </a>
              </div>
        </div><!-- /.repository-sidebar -->

        <div id="js-repo-pjax-container" class="repository-content context-loader-container" data-pjax-container>
          

<a href="/diegovalle/mxmortalitydb/blob/228d9754b57109a4f3aa51a74f92d683ad1c33c1/readme.md" class="hidden js-permalink-shortcut" data-hotkey="y">Permalink</a>

<!-- blob contrib key: blob_contributors:v21:46bb4085d1ffb6f4b4a32b07e3eaf33e -->

<div class="file-navigation js-zeroclipboard-container">
  
<div class="select-menu js-menu-container js-select-menu left">
  <span class="btn btn-sm select-menu-button js-menu-target css-truncate" data-hotkey="w"
    data-master-branch="master"
    data-ref="master"
    title="master"
    role="button" aria-label="Switch branches or tags" tabindex="0" aria-haspopup="true">
    <span class="octicon octicon-git-branch"></span>
    <i>branch:</i>
    <span class="js-select-button css-truncate-target">master</span>
  </span>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax aria-hidden="true">

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <span class="select-menu-title">Switch branches/tags</span>
        <span class="octicon octicon-x js-menu-close" role="button" aria-label="Close"></span>
      </div>

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Filter branches/tags" id="context-commitish-filter-field" class="js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" data-filter-placeholder="Filter branches/tags" class="js-select-menu-tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" data-filter-placeholder="Find a tag…" class="js-select-menu-tab">Tags</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open selected"
               href="/diegovalle/mxmortalitydb/blob/master/readme.md"
               data-name="master"
               data-skip-pjax="true"
               rel="nofollow">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <span class="select-menu-item-text css-truncate-target" title="master">
                master
              </span>
            </a>
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div>

    </div>
  </div>
</div>

  <div class="btn-group right">
    <a href="/diegovalle/mxmortalitydb/find/master"
          class="js-show-file-finder btn btn-sm empty-icon tooltipped tooltipped-s"
          data-pjax
          data-hotkey="t"
          aria-label="Quickly jump between files">
      <span class="octicon octicon-list-unordered"></span>
    </a>
    <button aria-label="Copy file path to clipboard" class="js-zeroclipboard btn btn-sm zeroclipboard-button" data-copied-hint="Copied!" type="button"><span class="octicon octicon-clippy"></span></button>
  </div>

  <div class="breadcrumb js-zeroclipboard-target">
    <span class='repo-root js-repo-root'><span itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="/diegovalle/mxmortalitydb" class="" data-branch="master" data-direction="back" data-pjax="true" itemscope="url"><span itemprop="title">mxmortalitydb</span></a></span></span><span class="separator">/</span><strong class="final-path">readme.md</strong>
  </div>
</div>

<include-fragment class="commit commit-loader file-history-tease" src="/diegovalle/mxmortalitydb/contributors/master/readme.md">
  <div class="file-history-tease-header">
    Fetching contributors&hellip;
  </div>

  <div class="participation">
    <p class="loader-loading"><img alt="" height="16" src="https://assets-cdn.github.com/assets/spinners/octocat-spinner-32-EAF2F5-0bdc57d34b85c4a4de9d0d1db10cd70e8a95f33ff4f46c5a8c48b4bf4e5a9abe.gif" width="16" /></p>
    <p class="loader-error">Cannot retrieve contributors at this time</p>
  </div>
</include-fragment>
<div class="file">
  <div class="file-header">
    <div class="file-actions">

      <div class="btn-group">
        <a href="/diegovalle/mxmortalitydb/raw/master/readme.md" class="btn btn-sm " id="raw-url">Raw</a>
          <a href="/diegovalle/mxmortalitydb/blame/master/readme.md" class="btn btn-sm js-update-url-with-hash">Blame</a>
        <a href="/diegovalle/mxmortalitydb/commits/master/readme.md" class="btn btn-sm " rel="nofollow">History</a>
      </div>


          <button type="button" class="octicon-btn disabled tooltipped tooltipped-n" aria-label="You must be signed in to make or propose changes">
            <span class="octicon octicon-pencil"></span>
          </button>

        <button type="button" class="octicon-btn octicon-btn-danger disabled tooltipped tooltipped-n" aria-label="You must be signed in to make or propose changes">
          <span class="octicon octicon-trashcan"></span>
        </button>
    </div>

    <div class="file-info">
        265 lines (214 sloc)
        <span class="file-info-divider"></span>
      12.051 kb
    </div>
  </div>
    <div id="readme" class="blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a id="user-content-mexican-injury-intent-deaths-2004-2013" class="anchor" href="#mexican-injury-intent-deaths-2004-2013" aria-hidden="true"><span class="octicon octicon-link"></span></a>Mexican Injury Intent Deaths 2004-2013</h1>

<p>This is a data only package containing all injury intent deaths (accidents, suicides, homicides, legal interventions, and deaths of unspecified intent) registered by the SSA/INEGI from 2004 to 2013. The data source for the database is the <a href="http://www.inegi.org.mx/est/contenidos/proyectos/registros/vitales/mortalidad/default.aspx">INEGI</a>. In addition the data was coded with the Injury Mortality Matrix provided by the <a href="http://www.cdc.gov/nchs/data/ice/icd10_transcode.pdf">CDC</a>. The code used to clean the database is available <a href="https://github.com/diegovalle/death.index">as a separate program</a></p>

<h2>
<a id="user-content-installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>devtools::install_github("diegovalle/mxmortalitydb")</p>

<div class="highlight highlight-s"><pre><span class="pl-c">## Uncomment the following lines to install </span>
<span class="pl-c">## install.packages('devtools')</span>

<span class="pl-c">## library(devtools)</span>

<span class="pl-c">## install_github('mxmortalitydb', 'diegovalle')</span></pre></div>

<div class="highlight highlight-s"><pre>library(mxmortalitydb)
library(stringr)
library(plyr)
library(ggplot2)
library(grid) <span class="pl-c">## needed for arrow</span></pre></div>

<h2>
<a id="user-content-examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h2>

<p>All deaths of unknown intent in Sinaloa (state code 25) where the injury mechanism was a firearm, by year of registration:</p>

<div class="highlight highlight-s"><pre><span class="pl-c">## The main data.frame in the package is called injury.intent</span>
ddply(subset(injury.intent, is.na(intent) &amp; mechanism == <span class="pl-s"><span class="pl-pds">"</span>Firearm<span class="pl-pds">"</span></span> &amp; state_reg == 
    <span class="pl-c1">25</span>), .(year_reg, intent), summarise, count = length(state_reg))</pre></div>

<pre><code>##   year_reg intent count
## 1     2004   &lt;NA&gt;    11
## 2     2005   &lt;NA&gt;    11
## 3     2006   &lt;NA&gt;     2
## 4     2009   &lt;NA&gt;     8
## 5     2010   &lt;NA&gt;     7
## 6     2011   &lt;NA&gt;    25
## 7     2012   &lt;NA&gt;   197
</code></pre>

<p>In addition to the <strong>injury.intent</strong> data.frame several other datasets are available:</p>

<ul class="task-list">
<li>
<strong>aggressor.relation.code</strong> (relationship between the aggressor and his victim, useful for merging aggressor_relationship_code, Spanish)</li>
<li>
<strong>geo.codes</strong> (names of states and municipios, useful for merging state_reg, state_occur_death and mun_reg, mun_occur_death codes)</li>
<li>
<strong>icd.103</strong> (list of 103 categories in the WHO mortality, Spanish)</li>
<li>
<strong>metro.areas</strong> (2010 metro areas as defined by the CONAPO along with 2010 population counts)</li>
<li>
<strong>big.municipios</strong> (since metro areas are not statistical in nature this is a list of all 
municipios which are bigger than the smallest metro area but are not part of one)</li>
<li>
<strong>mex.list.group</strong> (groups of diseases, Spanish)</li>
<li>
<strong>mex.list</strong> (list of diseases, Spanish)</li>
</ul>

<p>Homicides merged with the aggressor.relation.code table:</p>

<div class="highlight highlight-s"><pre><span class="pl-c1">df</span> &lt;- ddply(subset(injury.intent, intent == <span class="pl-s"><span class="pl-pds">"</span>Homicide<span class="pl-pds">"</span></span>), .(year_reg, aggressor_relation_code), 
    summarise, count = length(state_reg))
<span class="pl-c">## A couple of other tables are included in the package to interpret some of</span>
<span class="pl-c">## the values in injury.intent</span>
merge(<span class="pl-c1">df</span>, aggressor.relation.code)</pre></div>

<pre><code>##    aggressor_relation_code year_reg count            relationship
## 1                        1     2012    25                   Padre
## 2                        2     2012    64                   Madre
## 3                        3     2012    14                 Hermano
## 4                        4     2012     7                 Hermana
## 5                        5     2012    10                    Hijo
## 6                        6     2012     1                    Hija
## 7                        7     2012     5                  Abuelo
## 8                        8     2012     3                  Abuela
## 9                        9     2012     5                   Nieto
## 10                      10     2012     1                   Nieta
## 11                      11     2012    27         Esposo, Cónyuge
## 12                      12     2012     3         Esposa, Cónyuge
## 13                      13     2012     7                     Tío
## 14                      14     2012     1                     Tía
## 15                      15     2012    19                 Sobrino
## 16                      17     2012    14                   Primo
## 17                      21     2012     1                Bisnieto
## 18                      27     2012     2                  Suegro
## 19                      31     2012     4                   Yerno
## 20                      33     2012     9                  Cuñado
## 21                      34     2012     1                  Cuñada
## 22                      35     2012     1                 Concuño
## 23                      37     2012     6               Padrastro
## 24                      39     2012     2                Hijastro
## 25                      41     2012     1             Hermanastro
## 26                      45     2012     9    Concubino, compañero
## 27                      46     2012     4    Concubina, compañera
## 28                      47     2012     3 Amante, Amasio, Querido
## 29                      49     2012     2                   Novio
## 30                      51     2012     3               Ex esposo
## 31                      57     2012     1                Compadre
## 32                      66     2012     5                Conocido
## 33                      67     2012     5                  Vecino
## 34                      68     2012     6                   Amigo
## 35                      69     2012     1                   Amiga
## 36                      70     2012     3           Otro familiar
## 37                      71     2012     1          Sin parentesco
## 38                      72     2012   438                 Ninguno
## 39                      99     2012 25253         No especificado
</code></pre>

<p>A plot of female homicide counts (making sure to exclude those that occurred outside Mexico):</p>

<div class="highlight highlight-s"><pre><span class="pl-c">## make sure to only count deaths that occurred inside Mexico (codes 33 to 35</span>
<span class="pl-c">## are USA, LATAM and Other)</span>
<span class="pl-c1">df</span> &lt;- ddply(subset(injury.intent, sex == <span class="pl-s"><span class="pl-pds">"</span>Female<span class="pl-pds">"</span></span> &amp; intent == <span class="pl-s"><span class="pl-pds">"</span>Homicide<span class="pl-pds">"</span></span> &amp; !state_occur_death %<span class="pl-k">in</span>% 
    <span class="pl-c1">33</span>:<span class="pl-c1">35</span>), .(year_reg, intent), summarise, count = length(state_reg))
ggplot(<span class="pl-c1">df</span>, aes(year_reg, count)) + geom_line() + labs(title = <span class="pl-s"><span class="pl-pds">"</span>Female homicides in Mexico, by year of registration<span class="pl-pds">"</span></span>)</pre></div>

<p><a href="https://camo.githubusercontent.com/f35eab1a7dc58e814e2b760298a8da0caf9689b7/687474703a2f2f692e696d6775722e636f6d2f3336394c414e722e706e67" target="_blank"><img src="https://camo.githubusercontent.com/f35eab1a7dc58e814e2b760298a8da0caf9689b7/687474703a2f2f692e696d6775722e636f6d2f3336394c414e722e706e67" alt="plot of chunk unnamed-chunk-5" data-canonical-src="http://i.imgur.com/369LANr.png" style="max-width:100%;"></a> </p>

<p>Homicides in the Mexico City metro area (ZM Valle de México), by state where the murder was registered</p>

<div class="highlight highlight-s"><pre>plotMetro &lt;- function(metro.name) {
    require(stringr)
    <span class="pl-c">## data.frame metro.areas contains the 2010 CONAPO metro areas</span>
    <span class="pl-c1">df</span> &lt;- merge(injury.intent, metro.areas, by.x = <span class="pl-c1">c</span>(<span class="pl-s"><span class="pl-pds">"</span>state_reg<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>mun_reg<span class="pl-pds">"</span></span>), 
        by.y = <span class="pl-c1">c</span>(<span class="pl-s"><span class="pl-pds">"</span>state_code<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>mun_code<span class="pl-pds">"</span></span>))
    <span class="pl-c">## Homicides in Mexico City, by state of registration</span>
    <span class="pl-c1">df2</span> &lt;- ddply(subset(<span class="pl-c1">df</span>, metro_area == metro.name &amp; intent == <span class="pl-s"><span class="pl-pds">"</span>Homicide<span class="pl-pds">"</span></span>), .(state_reg, year_reg), 
        summarise, count = length(state_reg))
    <span class="pl-c">## data.frame geo.codes contains the names of Mexican states (with mun_code</span>
    <span class="pl-c">## 0) and municipios</span>
    <span class="pl-c1">df2</span> &lt;- merge(<span class="pl-c1">df2</span>, subset(geo.codes, mun_code == <span class="pl-c1">0</span>), by.x = <span class="pl-s"><span class="pl-pds">"</span>state_reg<span class="pl-pds">"</span></span>, 
        by.y = <span class="pl-s"><span class="pl-pds">"</span>state_code<span class="pl-pds">"</span></span>)
    ggplot(<span class="pl-c1">df2</span>, aes(year_reg, count, group = state_reg, color = name)) + geom_line() + 
        labs(title = str_c(<span class="pl-s"><span class="pl-pds">"</span>Homicides in <span class="pl-pds">"</span></span>, metro.name, <span class="pl-s"><span class="pl-pds">"</span>, by state of registration<span class="pl-pds">"</span></span>))
}
plotMetro(<span class="pl-s"><span class="pl-pds">"</span>Valle de México<span class="pl-pds">"</span></span>)</pre></div>

<pre><code>## Loading required package: stringr
</code></pre>

<p><a href="https://camo.githubusercontent.com/ad7439a0e5ff915ee3aefc5425838287d689f135/687474703a2f2f692e696d6775722e636f6d2f37324d793754682e706e67" target="_blank"><img src="https://camo.githubusercontent.com/ad7439a0e5ff915ee3aefc5425838287d689f135/687474703a2f2f692e696d6775722e636f6d2f37324d793754682e706e67" alt="plot of chunk unnamed-chunk-6" data-canonical-src="http://i.imgur.com/72My7Th.png" style="max-width:100%;"></a> </p>

<p>Since metro.area dataframe containes the 2010 population we can plot changes in homicides rates (the rate will be overstimated by a little bit since we are using 2010 data):</p>

<div class="highlight highlight-s"><pre>plotChanges &lt;- function(<span class="pl-c1">df</span>, metro.areas, country.rate, years) {
  <span class="pl-c">## Where the municipio where the death occurred is unknown use</span>
  <span class="pl-c">## the municipio where it was registered as place of occurrance</span>
  <span class="pl-c1">df</span>[<span class="pl-c1">df</span>$mun_occur_death==<span class="pl-c1">999</span>, ]$mun_occur_death  &lt;- 
    <span class="pl-c1">df</span>[<span class="pl-c1">df</span>$mun_occur_death==<span class="pl-c1">999</span>, ]$mun_reg

  <span class="pl-c">## Counts of homicide by state and municipio</span>
  <span class="pl-c1">df</span> &lt;- ddply(subset(<span class="pl-c1">df</span>, year_reg %<span class="pl-k">in</span>% years &amp; intent.imputed == <span class="pl-s"><span class="pl-pds">"</span>Homicide<span class="pl-pds">"</span></span>), 
              .(state_occur_death, mun_occur_death, year_reg), 
              summarise, count = length(state_reg))
  <span class="pl-c">## Merge the counts with our fake metro areas</span>
  <span class="pl-c1">df</span> &lt;- merge(<span class="pl-c1">df</span>, metro.areas, by.x = <span class="pl-c1">c</span>(<span class="pl-s"><span class="pl-pds">"</span>state_occur_death<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>mun_occur_death<span class="pl-pds">"</span></span>), 
              by.y = <span class="pl-c1">c</span>(<span class="pl-s"><span class="pl-pds">"</span>state_code<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>mun_code<span class="pl-pds">"</span></span>))
  <span class="pl-c">## Now get the counts by metro area (which may contain more than one municipio)</span>
  <span class="pl-c1">df</span> &lt;- ddply(<span class="pl-c1">df</span>, .(metro_area, year_reg), summarise,
              count = sum(count), 
              population = sum(mun_population_2010),
              rate = count / population * <span class="pl-c1">10</span>^<span class="pl-c1">5</span>)
  <span class="pl-c">## We are only interesed if the metro area at some time had a homicide rate of 15</span>
  <span class="pl-c1">df</span> &lt;- subset(<span class="pl-c1">df</span>, metro_area %<span class="pl-k">in</span>% subset(<span class="pl-c1">df</span>, rate &gt; <span class="pl-c1">15</span>)$metro_area)
  <span class="pl-c">## Make sure the dataframe is ordered by metro and year</span>
  <span class="pl-c1">df</span> &lt;- <span class="pl-c1">df</span>[order(<span class="pl-c1">df</span>$metro_area, <span class="pl-c1">df</span>$year_reg),]
  <span class="pl-c">## Order the chart by homicide rate in 2012</span>
  <span class="pl-c1">df</span>$metro_area &lt;- reorder(<span class="pl-c1">df</span>$metro_area, <span class="pl-c1">df</span>$rate, function(x) x[[<span class="pl-c1">2</span>]])
  <span class="pl-c">## Data frame for the arrow structure</span>
  arrows &lt;- ddply(<span class="pl-c1">df</span>, .(metro_area), summarise, 
                  start =  rate[<span class="pl-c1">1</span>],
                  end = rate[<span class="pl-c1">2</span>],
                  metro_area = metro_area[<span class="pl-c1">1</span>],
                  change = ifelse(rate[<span class="pl-c1">1</span>] &gt;= rate[<span class="pl-c1">2</span>], <span class="pl-s"><span class="pl-pds">"</span>decrease<span class="pl-pds">"</span></span> ,<span class="pl-s"><span class="pl-pds">"</span>increase<span class="pl-pds">"</span></span>))

  ggplot(<span class="pl-c1">df</span>,
         aes(rate, metro_area, group = as.factor(year_reg), color = as.factor(year_reg))) +
    geom_point(aes(size = log(count))) +
    labs(title = <span class="pl-s"><span class="pl-pds">"</span>Homicide (and deaths of unknown intent classified as homicide) rates and trends<span class="pl-pds">"</span></span>) +
    scale_size(<span class="pl-s"><span class="pl-pds">"</span>number\nof\nhomicides<span class="pl-pds">"</span></span>, breaks = <span class="pl-c1">c</span>(log(<span class="pl-c1">50</span>),log(<span class="pl-c1">500</span>),log(<span class="pl-c1">3000</span>)),
               labels = <span class="pl-c1">c</span>(<span class="pl-c1">50</span>, <span class="pl-c1">500</span>, <span class="pl-c1">3000</span>)) +
    geom_segment(data = arrows, aes(x= start , y = metro_area, 
                                    xend = end, yend = metro_area,
                                    group = change, color = change), 
                 arrow=arrow(length=unit(<span class="pl-c1">0</span>.<span class="pl-c1">3</span>,<span class="pl-s"><span class="pl-pds">"</span>cm<span class="pl-pds">"</span></span>)), alpha = .<span class="pl-c1">8</span>) +
    scale_color_manual(<span class="pl-s"><span class="pl-pds">"</span>year\nand\ntrend<span class="pl-pds">"</span></span>, 
                       values = <span class="pl-c1">c</span>(<span class="pl-s"><span class="pl-pds">"</span>gray<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>black<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>blue<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>)) +
    ylab(<span class="pl-s"><span class="pl-pds">"</span>metro area<span class="pl-pds">"</span></span>) +
    xlab(<span class="pl-s"><span class="pl-pds">"</span>homicide rate<span class="pl-pds">"</span></span>) +
    scale_x_log10()+
    geom_vline(xintercept = country.rate, linetype = <span class="pl-c1">2</span>) +
    annotate(<span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span>,  y = <span class="pl-s"><span class="pl-pds">"</span>Tapachula<span class="pl-pds">"</span></span>, x = <span class="pl-c1">26</span>, label = <span class="pl-s"><span class="pl-pds">"</span>country\naverage<span class="pl-pds">"</span></span>,
             hjust = -<span class="pl-c1">0</span>.<span class="pl-c1">1</span>, size = <span class="pl-c1">4</span>) +
    theme_bw()
}

<span class="pl-c">## Let's treat the big municipalities which are not part of a metro area</span>
<span class="pl-c">## as if they were one</span>
<span class="pl-c">## rename big.municipios to merge with metro.areas</span>
big.municipios2 &lt;- big.municipios
names(big.municipios2) &lt;- <span class="pl-c1">c</span>(<span class="pl-s"><span class="pl-pds">"</span>state_code<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>mun_code<span class="pl-pds">"</span></span>,
                            <span class="pl-s"><span class="pl-pds">"</span>mun_population_2010<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>metro_area<span class="pl-pds">"</span></span>)
metro.areas.fake &lt;- rbind.fill(metro.areas, big.municipios2)

<span class="pl-c">## Changes from 2011 to 2012 when the country homicide rate was 24.5</span>
plotChanges(injury.intent, metro.areas.fake, <span class="pl-c1">24</span>.<span class="pl-c1">5</span>, <span class="pl-c1">c</span>(<span class="pl-c1">2011</span>,<span class="pl-c1">2012</span>))
<span class="pl-c">## Changes from 2006 to 2012 when the country homicide rate was 24.5</span>
plotChanges(injury.intent, metro.areas.fake, <span class="pl-c1">24</span>.<span class="pl-c1">5</span>, <span class="pl-c1">c</span>(<span class="pl-c1">2011</span>,<span class="pl-c1">2012</span>))</pre></div>

<p><a href="https://camo.githubusercontent.com/ad7439a0e5ff915ee3aefc5425838287d689f135/687474703a2f2f692e696d6775722e636f6d2f37324d793754682e706e67" target="_blank"><img src="https://camo.githubusercontent.com/ad7439a0e5ff915ee3aefc5425838287d689f135/687474703a2f2f692e696d6775722e636f6d2f37324d793754682e706e67" alt="plot of chunk unnamed-chunk-6" data-canonical-src="http://i.imgur.com/72My7Th.png" style="max-width:100%;"></a> 
<a href="https://camo.githubusercontent.com/ad7439a0e5ff915ee3aefc5425838287d689f135/687474703a2f2f692e696d6775722e636f6d2f37324d793754682e706e67" target="_blank"><img src="https://camo.githubusercontent.com/ad7439a0e5ff915ee3aefc5425838287d689f135/687474703a2f2f692e696d6775722e636f6d2f37324d793754682e706e67" alt="plot of chunk unnamed-chunk-6" data-canonical-src="http://i.imgur.com/72My7Th.png" style="max-width:100%;"></a> </p>

<h2>
<a id="user-content-warning" class="anchor" href="#warning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Warning</h2>

<p>I encourage you to get acquainted with the database since it may contain some errors (introduced at the source) and some fields may be difficult to interpret because of the large number of missing values (see the aggressor relation example). The field <em>intent.imputed</em> is the result of running a statistical model to impute the intent of deaths of unknown intent, and correct some errors in the way homicides were recorded in Baja California, Sinaloa, and the Federal District. It is mainly useful to the author of this package. Feel free to ignore the column.</p>

<p>Total Imputed Homicides in Mexico:</p>

<div class="highlight highlight-s"><pre><span class="pl-c">## make sure to only count deaths that occurred inside Mexico (codes 33 to 35</span>
<span class="pl-c">## are USA, LATAM and Other)</span>
ddply(subset(injury.intent, intent.imputed == <span class="pl-s"><span class="pl-pds">"</span>Homicide<span class="pl-pds">"</span></span> &amp; !state_occur_death %<span class="pl-k">in</span>% 
    <span class="pl-c1">33</span>:<span class="pl-c1">35</span>), .(year_reg), summarise, count = length(state_reg))</pre></div>

<pre><code>##   year_reg count
## 1     2004 10554
## 2     2005 11129
## 3     2006 11615
## 4     2007 10456
## 5     2008 15391
## 6     2009 21220
## 7     2010 27660
## 8     2011 30312
## 9     2012 28086
</code></pre>

<h2>
<a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>This package is free and open source software, licensed <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.</p>
</article>
  </div>

</div>

<a href="#jump-to-line" rel="facebox[.linejump]" data-hotkey="l" style="display:none">Jump to Line</a>
<div id="jump-to-line" style="display:none">
  <form accept-charset="UTF-8" class="js-jump-to-line-form">
    <input class="linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" autofocus>
    <button type="submit" class="btn">Go</button>
  </form>
</div>

        </div>

      </div><!-- /.repo-container -->
      <div class="modal-backdrop"></div>
    </div><!-- /.container -->
  </div><!-- /.site -->


    </div><!-- /.wrapper -->

      <div class="container">
  <div class="site-footer" role="contentinfo">
    <ul class="site-footer-links right">
        <li><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
      <li><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
      <li><a href="https://shop.github.com" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
        <li><a href="https://github.com/blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a href="https://github.com/about" data-ga-click="Footer, go to about, text:about">About</a></li>

    </ul>

    <a href="https://github.com" aria-label="Homepage">
      <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
</a>
    <ul class="site-footer-links">
      <li>&copy; 2015 <span title="0.03444s from github-fe123-cp1-prd.iad.github.net">GitHub</span>, Inc.</li>
        <li><a href="https://github.com/site/terms" data-ga-click="Footer, go to terms, text:terms">Terms</a></li>
        <li><a href="https://github.com/site/privacy" data-ga-click="Footer, go to privacy, text:privacy">Privacy</a></li>
        <li><a href="https://github.com/security" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li><a href="https://github.com/contact" data-ga-click="Footer, go to contact, text:contact">Contact</a></li>
    </ul>
  </div>
</div>


    <div class="fullscreen-overlay js-fullscreen-overlay" id="fullscreen_overlay">
  <div class="fullscreen-container js-suggester-container">
    <div class="textarea-wrap">
      <textarea name="fullscreen-contents" id="fullscreen-contents" class="fullscreen-contents js-fullscreen-contents" placeholder=""></textarea>
      <div class="suggester-container">
        <div class="suggester fullscreen-suggester js-suggester js-navigation-container"></div>
      </div>
    </div>
  </div>
  <div class="fullscreen-sidebar">
    <a href="#" class="exit-fullscreen js-exit-fullscreen tooltipped tooltipped-w" aria-label="Exit Zen Mode">
      <span class="mega-octicon octicon-screen-normal"></span>
    </a>
    <a href="#" class="theme-switcher js-theme-switcher tooltipped tooltipped-w"
      aria-label="Switch themes">
      <span class="octicon octicon-color-mode"></span>
    </a>
  </div>
</div>



    
    

    <div id="ajax-error-message" class="flash flash-error">
      <span class="octicon octicon-alert"></span>
      <a href="#" class="octicon octicon-x flash-close js-ajax-error-dismiss" aria-label="Dismiss error"></a>
      Something went wrong with that request. Please try again.
    </div>


      <script crossorigin="anonymous" src="https://assets-cdn.github.com/assets/frameworks-d22b59d0085e83b7549ba4341ec9e68f80c2f29c8e49213ee182003dc8d568c6.js"></script>
      <script async="async" crossorigin="anonymous" src="https://assets-cdn.github.com/assets/github-0bc0f45c838b5d9d25bc071d2a4b0abe759a093392087dce55cd2caa00ea4f36.js"></script>
      
      

  </body>
</html>

